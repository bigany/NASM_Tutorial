; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27026.1 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	__local_stdio_printf_options
PUBLIC	_vfprintf_l
PUBLIC	printf
PUBLIC	correlation_ref
PUBLIC	main
EXTRN	__imp_QueryPerformanceCounter:PROC
EXTRN	__imp_QueryPerformanceFrequency:PROC
EXTRN	free:PROC
EXTRN	malloc:PROC
EXTRN	srand:PROC
EXTRN	rand:PROC
EXTRN	__acrt_iob_func:PROC
EXTRN	__stdio_common_vfprintf:PROC
EXTRN	correlation_avx:PROC
EXTRN	_fltused:DWORD
_DATA	SEGMENT
COMM	?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:QWORD							; `__local_stdio_printf_options'::`2'::_OptionsStorage
_DATA	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$_vfprintf_l DD imagerel $LN4
	DD	imagerel $LN4+80
	DD	imagerel $unwind$_vfprintf_l
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$printf DD imagerel $LN6
	DD	imagerel $LN6+83
	DD	imagerel $unwind$printf
pdata	ENDS
pdata	SEGMENT
$pdata$correlation_ref DD imagerel $LN21
	DD	imagerel $LN21+74
	DD	imagerel $unwind$correlation_ref
$pdata$4$correlation_ref DD imagerel $LN21+74
	DD	imagerel $LN21+362
	DD	imagerel $chain$4$correlation_ref
$pdata$5$correlation_ref DD imagerel $LN21+362
	DD	imagerel $LN21+770
	DD	imagerel $chain$5$correlation_ref
$pdata$main DD	imagerel $LN11
	DD	imagerel $LN11+295
	DD	imagerel $unwind$main
pdata	ENDS
_DATA	SEGMENT
$SG97284 DB	'Time taken is: %f', 0aH, 'The correlation is: %f', 0aH, 00H
_DATA	ENDS
xdata	SEGMENT
$unwind$correlation_ref DD 081f01H
	DD	05881fH
	DD	067817H
	DD	07680fH
	DD	011010aH
$chain$4$correlation_ref DD 0a1c21H
	DD	0d81cH
	DD	01c814H
	DD	02b80fH
	DD	03a80aH
	DD	049805H
	DD	imagerel $LN21
	DD	imagerel $LN21+74
	DD	imagerel $unwind$correlation_ref
$chain$5$correlation_ref DD 021H
	DD	imagerel $LN21
	DD	imagerel $LN21+74
	DD	imagerel $unwind$correlation_ref
$unwind$main DD	0a1b01H
	DD	03681bH
	DD	0e3410H
	DD	0f00c7210H
	DD	07008e00aH
	DD	050066007H
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$printf DD 041b01H
	DD	07017521bH
	DD	030156016H
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$_vfprintf_l DD 081401H
	DD	0a6414H
	DD	095414H
	DD	083414H
	DD	070105214H
xdata	ENDS
; Function compile flags: /Ogtpy
_TEXT	SEGMENT
timerFreq$ = 32
argc$ = 112
argv$ = 120
endTimerValue$ = 128
startTimerValue$ = 136
main	PROC
; File c:\users\baojia\projects\masm\test.c
; Line 38
$LN11:
	mov	QWORD PTR [rsp+8], rbx
	push	rbp
	push	rsi
	push	rdi
	push	r14
	push	r15
	sub	rsp, 64					; 00000040H
; Line 39
	mov	ecx, 1
	vmovaps	XMMWORD PTR [rsp+48], xmm6
	call	srand
; Line 41
	mov	ecx, 400000000				; 17d78400H
	call	malloc
; Line 42
	mov	ecx, 400000000				; 17d78400H
	mov	r15, rax
	call	malloc
	mov	rbp, r15
	mov	r14, rax
	sub	rbp, rax
	mov	rdi, rax
	mov	esi, 50000000				; 02faf080H
$LL4@main:
; Line 45
	call	rand
	mov	ebx, eax
; Line 46
	call	rand
	lea	rdi, QWORD PTR [rdi+8]
	vxorps	xmm0, xmm0, xmm0
	vxorps	xmm1, xmm1, xmm1
; Line 47
	vcvtsi2sd xmm0, xmm0, ebx
	vmovsd	QWORD PTR [rdi+rbp-8], xmm0
; Line 48
	vcvtsi2sd xmm1, xmm1, eax
	vmovsd	QWORD PTR [rdi-8], xmm1
	sub	rsi, 1
	jne	SHORT $LL4@main
; Line 55
	lea	rcx, QWORD PTR timerFreq$[rsp]
	call	QWORD PTR __imp_QueryPerformanceFrequency
; Line 56
	lea	rcx, QWORD PTR startTimerValue$[rsp]
	call	QWORD PTR __imp_QueryPerformanceCounter
; Line 58
	mov	r8d, 50000000				; 02faf080H
	mov	rdx, r14
	mov	rcx, r15
	call	correlation_avx
; Line 60
	lea	rcx, QWORD PTR endTimerValue$[rsp]
	vmovaps	xmm6, xmm0
	call	QWORD PTR __imp_QueryPerformanceCounter
	vxorps	xmm2, xmm2, xmm2
; Line 62
	vcvtsi2sd xmm2, xmm2, QWORD PTR endTimerValue$[rsp]
	vxorps	xmm1, xmm1, xmm1
	vcvtsi2sd xmm1, xmm1, QWORD PTR startTimerValue$[rsp]
	vsubsd	xmm3, xmm2, xmm1
	vxorps	xmm2, xmm2, xmm2
	vcvtsi2sd xmm2, xmm2, QWORD PTR timerFreq$[rsp]
	vdivsd	xmm1, xmm3, xmm2
; Line 65
	vmovaps	xmm2, xmm6
	vmovq	r8, xmm2
	vmovq	rdx, xmm1
	lea	rcx, OFFSET FLAT:$SG97284
	call	printf
; Line 67
	mov	rcx, r15
	call	free
; Line 68
	mov	rcx, r14
	call	free
; Line 70
	mov	rbx, QWORD PTR [rsp+112]
	xor	eax, eax
	vmovaps	xmm6, XMMWORD PTR [rsp+48]
	add	rsp, 64					; 00000040H
	pop	r15
	pop	r14
	pop	rdi
	pop	rsi
	pop	rbp
	ret	0
main	ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
_TEXT	SEGMENT
x$ = 144
y$ = 152
n$ = 160
correlation_ref PROC
; File c:\users\baojia\projects\masm\test.c
; Line 14
$LN21:
	mov	rax, rsp
	sub	rsp, 136				; 00000088H
	vmovaps	XMMWORD PTR [rax-24], xmm6
; Line 15
	xor	r9d, r9d
	vmovaps	XMMWORD PTR [rax-40], xmm7
	mov	r11, rdx
	vmovaps	XMMWORD PTR [rax-56], xmm8
	mov	r10, rcx
	vxorpd	xmm8, xmm8, xmm8
	vxorpd	xmm5, xmm5, xmm5
	vxorpd	xmm6, xmm6, xmm6
	vxorpd	xmm7, xmm7, xmm7
	vxorpd	xmm4, xmm4, xmm4
; Line 21
	test	r8d, r8d
	jle	$LN13@correlatio
	cmp	r8d, 8
	jb	$LN9@correlatio
; Line 15
	vmovaps	XMMWORD PTR [rax-72], xmm9
	vmovaps	XMMWORD PTR [rax-88], xmm10
	vmovaps	XMMWORD PTR [rax-104], xmm11
	vmovaps	XMMWORD PTR [rax-120], xmm12
	mov	eax, r8d
	vmovaps	XMMWORD PTR [rsp], xmm13
	and	eax, -2147483641			; ffffffff80000007H
	jge	SHORT $LN19@correlatio
	dec	eax
	or	eax, -8
	inc	eax
$LN19@correlatio:
	mov	edx, r8d
	sub	edx, eax
	lea	rax, QWORD PTR [r11+32]
	sub	rcx, r11
	vxorpd	xmm9, xmm9, xmm9
	vxorpd	xmm10, xmm10, xmm10
	vxorpd	xmm11, xmm11, xmm11
	vxorpd	xmm12, xmm12, xmm12
	vxorpd	xmm13, xmm13, xmm13
	npad	7
$LL4@correlatio:
; Line 22
	vmovupd	ymm3, YMMWORD PTR [rcx+rax-32]
; Line 23
	vmovupd	ymm2, YMMWORD PTR [rax-32]
; Line 26
	vfmadd231pd ymm13, ymm2, ymm3
	vaddpd	ymm5, ymm5, ymm3
	vaddpd	ymm10, ymm10, ymm2
	vfmadd231pd ymm11, ymm3, ymm3
	vmovupd	ymm3, YMMWORD PTR [rcx+rax]
	vfmadd231pd ymm12, ymm2, ymm2
	vmovupd	ymm2, YMMWORD PTR [rax]
	add	r9d, 8
	lea	rax, QWORD PTR [rax+64]
	vaddpd	ymm9, ymm9, ymm3
	vaddpd	ymm6, ymm6, ymm2
	vfmadd231pd ymm7, ymm3, ymm3
	vfmadd231pd ymm8, ymm2, ymm2
	vfmadd231pd ymm4, ymm3, ymm2
	cmp	r9d, edx
	jl	SHORT $LL4@correlatio
; Line 15
	vaddpd	ymm0, ymm4, ymm13
	vmovaps	xmm13, XMMWORD PTR [rsp]
	vhaddpd	ymm2, ymm0, ymm0
	vextractf128 xmm1, ymm2, 1
	vaddpd	xmm4, xmm1, xmm2
	vaddpd	ymm0, ymm8, ymm12
	vmovaps	xmm12, XMMWORD PTR [rsp+16]
	vhaddpd	ymm2, ymm0, ymm0
	vextractf128 xmm1, ymm2, 1
	vaddpd	xmm8, xmm1, xmm2
	vaddpd	ymm0, ymm7, ymm11
	vmovaps	xmm11, XMMWORD PTR [rsp+32]
	vhaddpd	ymm2, ymm0, ymm0
	vextractf128 xmm1, ymm2, 1
	vaddpd	ymm0, ymm6, ymm10
	vmovaps	xmm10, XMMWORD PTR [rsp+48]
	vaddpd	xmm7, xmm1, xmm2
	vhaddpd	ymm2, ymm0, ymm0
	vextractf128 xmm1, ymm2, 1
	vaddpd	ymm0, ymm9, ymm5
	vmovaps	xmm9, XMMWORD PTR [rsp+64]
	vaddpd	xmm6, xmm1, xmm2
	vhaddpd	ymm2, ymm0, ymm0
	vextractf128 xmm1, ymm2, 1
	vaddpd	xmm5, xmm1, xmm2
$LN9@correlatio:
; Line 21
	cmp	r9d, r8d
	jge	$LN13@correlatio
	mov	eax, r8d
	sub	eax, r9d
	cmp	eax, 4
	jl	$LC14@correlatio
	movsxd	rcx, r9d
	mov	eax, r8d
	sub	eax, r9d
	inc	rcx
	sub	eax, 4
	mov	rdx, r10
	shr	eax, 2
	sub	rdx, r11
	inc	eax
	lea	rcx, QWORD PTR [r11+rcx*8]
	lea	r9d, DWORD PTR [r9+rax*4]
	npad	12
$LL15@correlatio:
; Line 22
	vmovsd	xmm3, QWORD PTR [rdx+rcx-8]
; Line 23
	vmovsd	xmm2, QWORD PTR [rcx-8]
; Line 26
	lea	rcx, QWORD PTR [rcx+32]
	vmulsd	xmm0, xmm2, xmm3
	vaddsd	xmm5, xmm5, xmm3
	vfmadd231sd xmm7, xmm3, xmm3
	vaddsd	xmm3, xmm4, xmm0
	vmovsd	xmm4, QWORD PTR [rcx+rdx-32]
	vaddsd	xmm6, xmm6, xmm2
	vfmadd231sd xmm8, xmm2, xmm2
	vmovsd	xmm2, QWORD PTR [rcx-32]
	vmulsd	xmm0, xmm4, xmm2
	vaddsd	xmm5, xmm5, xmm4
	vfmadd231sd xmm7, xmm4, xmm4
	vaddsd	xmm4, xmm3, xmm0
	vmovsd	xmm3, QWORD PTR [rdx+rcx-24]
	vaddsd	xmm6, xmm6, xmm2
	vfmadd231sd xmm8, xmm2, xmm2
	vmovsd	xmm2, QWORD PTR [rcx-24]
	vmulsd	xmm0, xmm2, xmm3
	vaddsd	xmm5, xmm5, xmm3
	vfmadd231sd xmm7, xmm3, xmm3
	vaddsd	xmm3, xmm4, xmm0
	vmovsd	xmm4, QWORD PTR [rdx+rcx-16]
	vaddsd	xmm6, xmm6, xmm2
	vfmadd231sd xmm8, xmm2, xmm2
	vmovsd	xmm2, QWORD PTR [rcx-16]
	vmulsd	xmm0, xmm2, xmm4
	vaddsd	xmm5, xmm5, xmm4
	vfmadd231sd xmm7, xmm4, xmm4
	vaddsd	xmm4, xmm3, xmm0
	vaddsd	xmm6, xmm6, xmm2
	vfmadd231sd xmm8, xmm2, xmm2
	sub	rax, 1
	jne	$LL15@correlatio
$LC14@correlatio:
; Line 21
	cmp	r9d, r8d
	jge	SHORT $LN13@correlatio
	movsxd	rax, r9d
	sub	r10, r11
	lea	rcx, QWORD PTR [r11+rax*8]
	mov	eax, r8d
	sub	eax, r9d
	movsxd	rdx, eax
$LC8@correlatio:
; Line 22
	vmovsd	xmm3, QWORD PTR [rcx+r10]
; Line 23
	vmovsd	xmm2, QWORD PTR [rcx]
	lea	rcx, QWORD PTR [rcx+8]
; Line 24
	vmovaps	xmm0, xmm3
	vfmadd213sd xmm0, xmm3, xmm7
	vmovapd	xmm7, xmm0
; Line 26
	vmovaps	xmm0, xmm2
	vmovaps	xmm1, xmm2
	vfmadd213sd xmm0, xmm3, xmm4
	vfmadd213sd xmm1, xmm2, xmm8
	vmovapd	xmm4, xmm0
	vaddsd	xmm5, xmm5, xmm3
	vaddsd	xmm6, xmm6, xmm2
	vmovapd	xmm8, xmm1
	sub	rdx, 1
	jne	SHORT $LC8@correlatio
$LN13@correlatio:
	vxorps	xmm2, xmm2, xmm2
; Line 31
	vcvtsi2sd xmm2, xmm2, r8d
	vmulsd	xmm0, xmm6, xmm5
	vfmsub213sd xmm4, xmm2, xmm0
	vmulsd	xmm1, xmm6, xmm6
	vmovaps	xmm3, xmm8
	vfmsub213sd xmm3, xmm2, xmm1
	vmulsd	xmm2, xmm2, xmm7
	vmulsd	xmm0, xmm5, xmm5
	vsubsd	xmm1, xmm2, xmm0
; Line 33
	vmulsd	xmm2, xmm3, xmm1
	vsqrtsd	xmm3, xmm2, xmm2
	vdivsd	xmm0, xmm4, xmm3
	vzeroupper
; Line 34
	vmovaps	xmm6, XMMWORD PTR [rsp+112]
	vmovaps	xmm7, XMMWORD PTR [rsp+96]
	vmovaps	xmm8, XMMWORD PTR [rsp+80]
	add	rsp, 136				; 00000088H
	ret	0
correlation_ref ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT printf
_TEXT	SEGMENT
_Format$ = 80
printf	PROC						; COMDAT
; File c:\program files (x86)\windows kits\10\include\10.0.17763.0\ucrt\stdio.h
; Line 954
$LN6:
	mov	QWORD PTR [rsp+8], rcx
	mov	QWORD PTR [rsp+16], rdx
	mov	QWORD PTR [rsp+24], r8
	mov	QWORD PTR [rsp+32], r9
	push	rbx
	push	rsi
	push	rdi
	sub	rsp, 48					; 00000030H
	mov	rdi, rcx
; Line 957
	lea	rsi, QWORD PTR _Format$[rsp+8]
; Line 958
	mov	ecx, 1
	call	__acrt_iob_func
	mov	rbx, rax
; Line 643
	call	__local_stdio_printf_options
	xor	r9d, r9d
	mov	QWORD PTR [rsp+32], rsi
	mov	r8, rdi
	mov	rdx, rbx
	mov	rcx, QWORD PTR [rax]
	call	__stdio_common_vfprintf
; Line 961
	add	rsp, 48					; 00000030H
	pop	rdi
	pop	rsi
	pop	rbx
	ret	0
printf	ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _vfprintf_l
_TEXT	SEGMENT
_Stream$ = 64
_Format$ = 72
_Locale$ = 80
_ArgList$ = 88
_vfprintf_l PROC					; COMDAT
; File c:\program files (x86)\windows kits\10\include\10.0.17763.0\ucrt\stdio.h
; Line 642
$LN4:
	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rbp
	mov	QWORD PTR [rsp+24], rsi
	push	rdi
	sub	rsp, 48					; 00000030H
	mov	rbx, r9
	mov	rdi, r8
	mov	rsi, rdx
	mov	rbp, rcx
; Line 643
	call	__local_stdio_printf_options
	mov	r9, rdi
	mov	QWORD PTR [rsp+32], rbx
	mov	r8, rsi
	mov	rdx, rbp
	mov	rcx, QWORD PTR [rax]
	call	__stdio_common_vfprintf
; Line 644
	mov	rbx, QWORD PTR [rsp+64]
	mov	rbp, QWORD PTR [rsp+72]
	mov	rsi, QWORD PTR [rsp+80]
	add	rsp, 48					; 00000030H
	pop	rdi
	ret	0
_vfprintf_l ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT __local_stdio_printf_options
_TEXT	SEGMENT
__local_stdio_printf_options PROC			; COMDAT
; File c:\program files (x86)\windows kits\10\include\10.0.17763.0\ucrt\corecrt_stdio_config.h
; Line 88
	lea	rax, OFFSET FLAT:?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
; Line 89
	ret	0
__local_stdio_printf_options ENDP
_TEXT	ENDS
END
